{% extends 'index-pdc.html' %}

{% block navegacion %}
  <div class="br-pageheader pd-y-15 pd-l-20">
    <nav class="breadcrumb pd-0 mg-0 tx-12">
      <a class="breadcrumb-item" > {{proyecto}} </a>
      <span class="breadcrumb-item active">Panel De Carga</span>
    </nav>
  </div>
{% endblock navegacion %}
{% load static %}
{% block <head> %}
  <link href="{% static 'lib/select2-4.0.13/css/select2.min.css' %}" rel="stylesheet" />
  <link href="{% static 'lib/select2-4.0.13/css/select2-bootstrap4.min.css' %}" rel="stylesheet" />
  <script src="{% static 'lib/select2-4.0.13/js/select2.min.js' %}"></script>
{%endblock%}


{% block content %}

<!--Titulo-->
  <div class="pd-x-20 pd-sm-x-30 pd-t-20 pd-sm-t-30">
    <h4 class="tx-gray-800 mg-b-5">Panel de carga de entregables.</h4>
    <p class="mg-b-0"></p>
  </div>

  <div class="br-section-wrapper">
<!--Tabla-->
  <div class="row row-sm d-flex justify-content-center" >
  <!--Upload Archivos-->
        <div class="col-12 bd rounded mg-t-10">
          
          <ul class="col-lg-12 nav nav-pills  justify-content-center" role="tablist">
            
          <h4 class="mg-b-0 tx-uppercase tx-bold tx-inverse tx-poppins mg-t-10" style="text-align: left; margin-right: 30px;" >{{proyecto}}</h4>

          <form  class="nav-item "method="POST" enctype="multipart/form-data">
            {% csrf_token %}

               <li class="nav-item float-left mg-t-7" style="width: auto;"><a class="nav-link active"><input type="file" name="importfile" id="fileInput" onchange="fileValidation()"></a></li>

              <li class="nav-item float-left"style="width: auto;"><a class="nav-link"><button class="btn btn-outline-danger" type="submit" disabled="disabled"> Importar </button></a></li>

            </form>

            <li class="nav-item float-left"style="width: auto;"><a class="nav-link" href="{% url 'documento-crear' %}"><button class="btn btn-outline-primary">Insertar por formulario</button></a></li>
            <li class="nav-item float-left"style="width: auto;"><a class="nav-link" href="{% url 'panel-export' %}"><button class="btn btn-outline-success"> Descargar Excel </button></a></li>
          </ul>
        </div>
<!-- 
  <form method="post" action="." enctype="multipart/form-data" ></form>
  <script>
    $(function (){
      var id = $(this).val();
      var select_documents = $('select[name=documentos]');
      var options = `<option value="">---------------------</option>`;
      if(id=== ''){
        select_documents.html(options);
        return false;
      }
      $.ajax({
        url: window.location.pathname,
        type: 'POST',
        data: {
          'action': 'search_document_id',
          'id': id
        },
        dataType: 'json',

      }).done(function(data)){

      }
      $('.select2').select2({
        theme: "bootstrap"
      });
    })
    

    "$('Select[name="Documentos]"').on('change',function () {...});"
  </script> -->

  <!--Table-->
      <div class="rounded table-responsive">

        <div class="col-2 mg-t-10 mg-b-10 float-left">
       <label for="">Buscar por Nombre:</label>
          <span class="select2 select2-container select2-container--default select2-container--below select2-container--focus" dir="ltr" style="width: 100%;">
          <span class="selection">
          <span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-yn2d-container">
          <span class="select2-selection__rendered" id="select2-yn2d-container">
          <span class="select2-selection__placeholder" >Choose one</span>
        </span>
          <span class="select2-selection__arrow" role="presentation"><b role="presentation"></b>
          </span>
          </span>
          </span>
          <span class="dropdown-wrapper" aria-hidden="true"></span></span>
        </div>
        <div class="col-2 mg-t-10 mg-b-10 float-left">
              
       <label for="">Buscar por tipo:</label>
                <span class="select2 select2-container select2-container--default select2-container--below select2-container--focus" dir="ltr" style="width: 100%;">
                <span class="selection">
                <span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-yn2d-container">
                <span class="select2-selection__rendered" id="select2-yn2d-container">
                <span class="select2-selection__placeholder">Choose one</span></span>
                <span class="select2-selection__arrow" role="presentation"><b role="presentation"></b>
                </span>
                </span>
                </span>
                <span class="dropdown-wrapper" aria-hidden="true"></span></span>
        </div>
        <div class="col-2 mg-t-10 mg-b-10 float-left">
                
          <label for="">Buscar por Descripcion:</label>
                   <span class="select2 select2-container select2-container--default select2-container--below select2-container--focus"value="Elegir"dir="ltr" style="width: 100%;">
                   <span class="selection">
                   <span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-yn2d-container">
                   <span class="select2-selection__rendered" id="select2-yn2d-container">
                   <span class="select2-selection__placeholder">Choose one</span></span>
                   <span class="select2-selection__arrow" role="presentation"><b role="presentation"></b>
                   </span>
                   </span>
                   </span>
                   <span class="dropdown-wrapper" aria-hidden="true"></span></span>
        </div>
        <div class="col-2 mg-t-10 mg-b-10 float-left">
                
       <label for="">Buscar por Numero :</label>
                <span class="select2 select2-container select2-container--default select2-container--below select2-container--focus"value="Elegir"dir="ltr" style="width: 100%;">
                <span class="selection">
                <span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-yn2d-container">
                <span class="select2-selection__rendered" id="select2-yn2d-container">
                <span class="select2-selection__placeholder">Choose one</span></span>
                <span class="select2-selection__arrow" role="presentation"><b role="presentation"></b>
                </span>
                </span>
                </span>
                <span class="dropdown-wrapper" aria-hidden="true"></span></span>
        </div>
        <div class="col-2 mg-t-10 mg-b-10 float-left">
                
          <label for="">desde:</label>
            <input type="date" class="form-control fc-datepicker" placeholder="DD/MM/AAAA">
        
        </div>
        <div class="col-2 mg-t-10 mg-b-10 float-left">                
          <label for="">Hasta:</label>
            <input type="date" id="datepickerNoOfMonths" class="form-control fc-datepicker" placeholder="DD/MM/AAAA">
          
        </div>

        <table class="table table-striped mg-b-0 table-bordered table-warning">
          <thead>
            <tr>
              <th style="text-align: center;border: 2px;border-color: grey; color: white;">Especialidad</th>
              <th style="text-align: center;border: 2px;border-color: grey; color: white;">Tipo <br> Doc.</th>
              <th style="text-align: center;border: 2px;border-color: grey; color: white;">Descripcion <br>Documentos</th>
              <th style="text-align: center;border: 2px;border-color: grey; color: white;">N° Documento <br>Contractual</th>
              <th style="text-align: center;border: 2px;border-color: grey; color: white;" colspan="2">Fecha Programada de Emision</th>              
              <th style="text-align: center;border: 2px;border-color: grey; color: white;" colspan="2">Acciones</th>
            </tr>
          </thead>
          <tbody>
          
            <tr>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
              <th style="text-align: center;border: 5px;border-color: black; color: grey;">Inicio Emision en Rev B</th>              
              <th style="text-align: center;border: 5px;border-color: black; color: grey;">Emision en Rev 0</th>
              <th style="text-align: center;border: 5px;border-color: black; color: black;">Modificar</th>
              <th style="text-align: center;border: 5px;border-color: black; color: black;">Eliminar</th>
            </tr>
            <!--Loop Listar Documento-->
            {% for documento in documentos %}
            <tr>
                <th style="text-align: center;border: 2px;border-color: grey; color: black;" > {{documento.especialidad}} </th>
                <th style="text-align: center;border: 2px;border-color: grey; color: black;" > {{documento.tipo}} </th>
                <th style="text-align: center;border: 2px;border-color: grey; color: black;" > {{documento.descripcion}} </th>
                <th style="text-align: center;border: 2px;border-color: grey; color: black;" > {{documento.num_documento}} </th>
                <th style="text-align: center;border: 2px;border-color: grey; color: black;" > {{documento.fecha_inicio_Emision}} </th>
                <th style="text-align: center;border: 2px;border-color: grey; color: black;" > {{documento.fecha_fin_Emision}}</th>
                <th><a href="{% url 'documento-actualizar' documento.pk %}" class="btn btn-teal"> Modificar </a></th>
                <th><a href="{% url 'documento-eliminar' documento.pk %}"onclick="window.opener.location.reload('{% url 'documento-eliminar' documento.pk %}');" class="btn btn-danger"> Eliminar </a></th>
            </tr>           
            
            {% empty %}
            <div class="modal fade in" id="myModal" role="dialog" style="display: block; padding-right: 16px;">
              <div class="modal-dialog" role="document">
                <div class="modal-content tx-size-sm">
                  <div class="modal-body tx-center pd-y-20 pd-x-20">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <i class="icon icon ion-ios-close-outline tx-100 tx-danger lh-1 mg-t-20 d-inline-block"></i>
                    <h4 class="tx-danger  tx-semibold mg-b-20">Error: No hay Información Ingresada!</h4>
                    <p class="mg-b-20 mg-x-20">Recuerde Que puede importar desde <strong>Excel</strong> o Insertar Manualmente por formulario.</p>
                    <button type="button" class="btn btn-danger tx-11 tx-uppercase pd-y-12 pd-x-25 tx-mont tx-medium mg-b-20" data-dismiss="modal" aria-label="Close">
                      Continue</button>
                    </div><!-- modal-body -->
                  </div><!-- modal-content -->
                </div><!-- modal-dialog -->
          </div>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" type="text/javascript"></script>
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>
          <script type="text/javascript">
           $(function(){
            $("#myModal").modal();
           });
          </script>
      {% endfor %}
            <!--Fin Loop-->
          </tbody>
        </table>
        




      {% if is_paginated %}
       <div class="ht-80 bd pd-x-20 d-flex align-items-center justify-content-between">
          <ul class="pagination pagination-basic mg-b-0">            
              {% if page_obj.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="ANTERIOR">                  
                <i class="fa fa-angle-left"></i>
                </a>                
                ANTERIOR 
              </li>
          </ul>
        {% endif %}
        {% if page_obj.has_next %}
          <ul class="pagination pagination-basic mg-b-0">
            <li class="page-item">
              <a href="?page={{ page_obj.next_page_number }}" class="page-link" aria-label="SIGUIENTE">
                <i class="fa fa-angle-right"></i>                
              </a>
              SIGUIENTE
            </li>
          </ul>      
      </div>  
      {% endif %}
      {% endif %}
      </div>
    </div>
  </div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>



<script>
  function fileValidation(){
      var fileInput = document.getElementById('file');
      var filePath = fileInput.value;
      var allowedExtensions = /(.xlsx|.xls|.csv)$/i;
      if(!allowedExtensions.exec(filePath)){
          alert('Porfavor, Adjuntar Archivos formato: .xlsx/ .xls/ .csv.');
          fileInput.value = '';
          return false;
      }else{
          //Image preview
          if (fileInput.files && fileInput.files[0]) {
              var reader = new FileReader();
              reader.onload = function(e) {
                  document.getElementById('imagePreview').innerHTML = '<img src="'+e.target.result+'"/>';
              };
              reader.readAsDataURL(fileInput.files[0]);
          }
      }
  }
</script>

<script>
        $(function(){
        'use strict'

        // Toggles
        $('.toggle').toggles({
          on: true,
          height: 26
        });

        // Input Masks
        $('#dateMask').mask('99/99/9999');
        $('#phoneMask').mask('(999) 999-9999');
        $('#ssnMask').mask('999-99-9999');

        // Datepicker
        $('.fc-datepicker').datepicker({
          showOtherMonths: true,
          selectOtherMonths: true
        });

        $('#datepickerNoOfMonths').datepicker({
          showOtherMonths: true,
          selectOtherMonths: true,
          numberOfMonths: 2
        });

        // Time Picker
        $('#tpBasic').timepicker();
        $('#tp2').timepicker({'scrollDefault': 'now'});
        $('#tp3').timepicker();

        $('#setTimeButton').on('click', function (){
          $('#tp3').timepicker('setTime', new Date());
        });

        // Color picker
        $('#colorpicker').spectrum({
          color: '#17A2B8'
        });

        $('#showAlpha').spectrum({
          color: 'rgba(23,162,184,0.5)',
          showAlpha: true
        });

        $('#showPaletteOnly').spectrum({
            showPaletteOnly: true,
            showPalette:true,
            color: '#DC3545',
            palette: [
                ['#1D2939', '#fff', '#0866C6','#23BF08', '#F49917'],
                ['#DC3545', '#17A2B8', '#6610F2', '#fa1e81', '#72e7a6']
            ]
        });


        // Rangeslider
        if($().ionRangeSlider) {
          $('#rangeslider1').ionRangeSlider();

          $('#rangeslider2').ionRangeSlider({
              min: 100,
              max: 1000,
              from: 550
          });

          $('#rangeslider3').ionRangeSlider({
              type: 'double',
              grid: true,
              min: 0,
              max: 1000,
              from: 200,
              to: 800,
              prefix: '$'
          });

          $('#rangeslider4').ionRangeSlider({
              type: 'double',
              grid: true,
              min: -1000,
              max: 1000,
              from: -500,
              to: 500,
              step: 250
          });
        }

      });
</script>
<script>
  $('#datepickerNoOfMonths').datepicker({
    showOtherMonths: true,
    selectOtherMonths: true,
    numberOfMonths: 1
  });
</script>
<script>
  $("#fileInput").change(function(){
    $("button").prop("disabled", this.files.length == 0);
});
</script>

{% endblock content %}
    